<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/80112adc65.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>CS261</title>
</head>
<body>
    <!-- Main View -->
    <div id="main-view" class="view-container">
        <div class="container-fluid">
            <!-- Your existing main view content -->
            <div class="row">
                <div class="col-7 position-relative">
                    <canvas id="junctionCanvas"></canvas>
                    <button id="editNorth" class="edit-arm-button" onclick="showEditor('north')">✏️ Edit Northbound</button>
                    <button id="editSouth" class="edit-arm-button" onclick="showEditor('south')">✏️ Edit Southbound</button>
                    <button id="editEast" class="edit-arm-button" onclick="showEditor('east')">✏️ Edit Eastbound</button>
                    <button id="editWest" class="edit-arm-button" onclick="showEditor('west')">✏️ Edit Westbound</button>
                </div>
                <div class="col-5">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column justify-content-between p-5">
                            <h1 class="text-center infobar-title">Junction Metrics</h5>
                            
                            <!-- Wait Times -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-clock me-3 stat-title"></i> Wait Times</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Time taken for the vehicle to leave the intersection"></i><br>
                                </div>
                                <div class="px-4">
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Mean:</div>
                                        <div id="meanWaitOverall" class="font-weight-bold stat">xxm:xxs</div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Maximum:</div>
                                        <div id="maxWaitOverall" class="font-weight-bold stat">xxm:xxs</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Queue Length -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-car me-3"></i> Queue Length</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Vehicles waiting in a junction arm after one complete traffic cycle"></i><br>
                                </div>
                                <div class="px-4 fs-4">
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Maximum:</div>
                                        <div id="maxQueueOverall" class="stat">xx cars</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Performance Score -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-trophy me-3"></i> Performance Score</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Efficiency of junction based on wait times and queue length"></i><br>
                                </div>
                                <div class="text-center">
                                    <div id="performanceOverall" class="performance-score text-primary font-weight-bold stat">47.83</div>
                                    <div class="performance-rank text-secondary stat">Top 41% of recorded scores</div>
                                </div>
                            </div>
                            
                            <button id="compareButton" class="btn btn-light text-primary w-100 stat">
                                Compare with other scores
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Editor View -->
    <div id="editor-view" class="view-container">
        <div class="container-fluid p-0">
            <!-- Your existing editor view content -->
            <div class="row">
                <div class="col-7">
                    <button class="puffin-crossing inactive" id="puffin" onclick="puffinToggle()">Puffin Inactive</button>
                    <div class="row editor-row">
                        <div id="columnsContainer"></div>
                        <div class="control-lane">
                            <button id="addLane" class="control-btn add-lane" onclick="increaseColumns()">Press to<br>Add<br>Lane</button>
                            <button id="removeLane" class="control-btn remove-lane" onclick="decreaseColumns()">Press to<br>Remove<br>Lane</button>
                        </div>
                    </div>
                    <div class="row border-top align-items-start">
                        <div class="col-5 text-center bottom-menu">
                            Hover over lanes for options<br>Click to toggle
                        </div>
                        <div class="col-4">
                            <div class="container d-flex justify-content-center align-items-center" style="height: 15vh;">
                                <div class="d-flex flex-column" style="width: 80%; height: 80%;">
                                    <nav aria-label="Priority navigation" class="h-100">
                                        <div class="d-flex flex-column h-100">
                                            <div class="text-center flex-grow-1 d-flex align-items-center justify-content-center">
                                                <span class="priority-label">Priority Unset</span>
                                                <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="define priority"></i><br>
                                            </div>
                                            <div class="flex-grow-1 d-flex align-items-center">
                                                <ul class="pagination justify-content-center w-100 mb-0">
                                                    <li id="priority1" class="page-item">
                                                        <a class="page-link text-center" href="#">1</a>
                                                    </li>
                                                    <li id="priority2" class="page-item">
                                                        <a class="page-link text-center" href="#">2</a>
                                                    </li>
                                                    <li id="priority3" class="page-item">
                                                        <a class="page-link text-center" href="#">3</a>
                                                    </li>
                                                    <li id="priority4" class="page-item">
                                                        <a class="page-link text-center" href="#">4</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </nav>
                                </div>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="container button-container">
                                <div class="button-group">
                                    <button id="applyChanges" class="btn btn-success action-button" 
                                            onclick="applyChanges()">Apply</button>
                                    <button id="cancelChanges" class="btn btn-danger action-button" 
                                            onclick="cancelChanges()">Cancel</button>
                                </div>   
                            </div>                          
                        </div>
                    </div>
                </div>
                <div class="col-5 info-column">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column justify-content-between p-5">
                            <h1 class="text-center infobar-title">Junction Metrics</h5>
                            
                            <!-- Wait Times -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-clock me-3 stat-title"></i> Wait Times</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Time taken for the vehicle to leave the intersection"></i><br>
           <br>
                                </div>
                                <div class="px-4">
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Mean:</div>
                                        <div id="meanWaitEditor" class="font-weight-bold stat">xxm:xxs</div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Maximum:</div>
                                        <div id="maxWaitEditor" class="font-weight-bold stat">xxm:xxs</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Queue Length -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-car me-3"></i> Queue Length</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Vehicles waiting in a junction arm after one complete traffic cycle"></i><br>
                                </div>
                                <div class="px-4 fs-4">
                                    <div class="d-flex justify-content-between">
                                        <div class="text-secondary stat">Maximum:</div>
                                        <div id="maxQueueEditor" class="stat">xx cars</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Performance Score -->
                            <div class="my-2">
                                <div class="d-flex align-items-center fs-4">
                                    <span class="stat-title"><i class="fa-solid fa-trophy me-3"></i> Performance Score</span>
                                    <i class="fa-solid fa-circle-info ms-2 text-secondary" style="margin-left: 10px;" data-bs-toggle="tooltip" 
           data-bs-placement="top" title="Efficiency of junction arm based on wait times and queue length"></i><br>
                                </div>
                                <div class="text-center">
                                    <div id="performanceEditor" class="performance-score text-primary font-weight-bold stat">47.83</div>
                                    <div class="performance-rank text-secondary stat">Top 41% of recorded scores</div>
                                </div>
                            </div>
                            
                            <button class="btn btn-light text-primary w-100 stat">
                                Compare with other scores
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Your existing script imports -->
    <script>
        let currentDirection = null;

        function showEditor(direction) {
            currentDirection = direction;
            document.getElementById('main-view').style.opacity = '0';
            document.getElementById('main-view').style.pointerEvents = 'none';
            document.getElementById('editor-view').style.opacity = '1';
            document.getElementById('editor-view').style.pointerEvents = 'auto';
            
            // Initialize editor for specific direction
            initializeEditor(direction);
        }

        function hideEditor() {
            document.getElementById('editor-view').style.opacity = '0';
            document.getElementById('editor-view').style.pointerEvents = 'none';
            document.getElementById('main-view').style.opacity = '1';
            document.getElementById('main-view').style.pointerEvents = 'auto';
            currentDirection = null;
        }

        function applyChanges() {
            // Save the changes for currentDirection
            saveEditorChanges(currentDirection);
            hideEditor();
        }

        function cancelChanges() {
            // Discard changes
            hideEditor();
        }

        function initializeEditor(direction) {
            // Load existing configuration for the direction
            // This function should be implemented in your editorScript.js
        }

        function saveEditorChanges(direction) {
            // Save the current editor state
            // This function should be implemented in your editorScript.js
        }
    </script>
    <script src="script.js"></script>
    <script src="editorScript.js"></script>
    <script src="flaskConnection.js"></script>
</body>
</html>